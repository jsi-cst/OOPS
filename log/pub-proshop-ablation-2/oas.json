{
    "openapi": "3.1.0",
    "info": {
        "title": "Auto-generated OAS of ProShop using OOPS",
        "version": "1.0.0"
    },
    "paths": {
        "/api/config/paypal": {
            "get": {
                "summary": "Get PayPal client ID configuration",
                "description": "Returns the PayPal client ID from the server environment (PAYPAL_CLIENT_ID). No authentication or parameters are required.",
                "operationId": "d97b217431ce04a0964d16b7f12191b8",
                "responses": {
                    "200": {
                        "description": "Successful response returning the PayPal client ID",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "clientId": {
                                            "type": [
                                                "string",
                                                "null"
                                            ],
                                            "description": "PayPal client ID from the server environment (may be null or absent if not configured)"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/upload": {
            "post": {
                "operationId": "da715466441543abefc9fc97776c7128",
                "requestBody": {
                    "content": {
                        "multipart/form-data": {
                            "schema": {
                                "properties": {
                                    "image": {
                                        "type": "string",
                                        "format": "binary",
                                        "description": "Image file to upload. Allowed types: jpeg, jpg, png, webp."
                                    }
                                },
                                "type": "object",
                                "required": [
                                    "image"
                                ]
                            }
                        }
                    },
                    "required": true
                },
                "responses": {
                    "200": {
                        "description": "Image uploaded successfully",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "message": {
                                            "type": "string",
                                            "example": "Image uploaded successfully"
                                        },
                                        "image": {
                                            "type": "string",
                                            "example": "/uploads/image-163434234234.jpg"
                                        }
                                    },
                                    "type": "object",
                                    "required": [
                                        "message",
                                        "image"
                                    ]
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Bad Request - invalid file or upload error",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "message": {
                                            "type": "string",
                                            "example": "Images only!"
                                        }
                                    },
                                    "type": "object",
                                    "required": [
                                        "message"
                                    ]
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/products": {
            "get": {
                "tags": [
                    "Products"
                ],
                "summary": "Fetch all products",
                "description": "Retrieve a paginated list of products. Supports optional keyword search (case-insensitive) and pagination via the pageNumber query parameter. Page size is controlled by the PAGINATION_LIMIT environment variable.",
                "operationId": "05e86603c4828532d813b3a018ec5147",
                "parameters": [
                    {
                        "description": "Optional search keyword to match product name (case-insensitive, used as a regex).",
                        "required": false,
                        "schema": {
                            "type": "string"
                        },
                        "name": "keyword",
                        "in": "query"
                    },
                    {
                        "description": "Page number for pagination (1-based). Defaults to 1 if not provided.",
                        "required": false,
                        "schema": {
                            "type": "integer",
                            "minimum": 1.0,
                            "default": 1
                        },
                        "name": "pageNumber",
                        "in": "query"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "A JSON object containing an array of products and pagination info.",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "products": {
                                            "items": {
                                                "type": "object",
                                                "description": "Product object"
                                            },
                                            "type": "array"
                                        },
                                        "page": {
                                            "type": "integer"
                                        },
                                        "pages": {
                                            "type": "integer"
                                        }
                                    },
                                    "type": "object",
                                    "required": [
                                        "products",
                                        "page",
                                        "pages"
                                    ]
                                }
                            }
                        }
                    }
                }
            },
            "post": {
                "tags": [
                    "Products"
                ],
                "summary": "Create a product",
                "description": "Create a new product (Private/Admin). The server initializes a sample product using the authenticated admin user's id and returns the created product with status 201.",
                "operationId": "7202073cc57e0d2d4247108bc2738b7e",
                "responses": {
                    "201": {
                        "description": "Product created",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "_id": {
                                            "type": "string"
                                        },
                                        "name": {
                                            "type": "string"
                                        },
                                        "price": {
                                            "type": "number"
                                        },
                                        "user": {
                                            "type": "string"
                                        },
                                        "image": {
                                            "type": "string"
                                        },
                                        "brand": {
                                            "type": "string"
                                        },
                                        "category": {
                                            "type": "string"
                                        },
                                        "countInStock": {
                                            "type": "integer"
                                        },
                                        "numReviews": {
                                            "type": "integer"
                                        },
                                        "description": {
                                            "type": "string"
                                        }
                                    },
                                    "type": "object",
                                    "required": [
                                        "name",
                                        "price",
                                        "user"
                                    ]
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Unauthorized"
                    },
                    "403": {
                        "description": "Forbidden"
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/api/products/{id}": {
            "get": {
                "summary": "Fetch single product",
                "description": "Fetch a single product by its id. Public access. Returns the product as JSON when found; if no product is found for a valid id, a 404 error with message 'Product not found' is returned.",
                "operationId": "86a0b42bad93e093f8520289d035cd96",
                "parameters": [
                    {
                        "description": "Product ID (MongoDB ObjectId)",
                        "required": true,
                        "schema": {
                            "type": "string"
                        },
                        "name": "id",
                        "in": "path"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Product found",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Product not found",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "message": {
                                            "type": "string"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    }
                }
            },
            "put": {
                "tags": [
                    "Products"
                ],
                "summary": "Update a product",
                "description": "Update a product by ID. Private/Admin access required.",
                "operationId": "9e5a57e3a484aa055401ed6c8c9d3be6",
                "parameters": [
                    {
                        "description": "ID of the product to update",
                        "required": true,
                        "schema": {
                            "type": "string"
                        },
                        "name": "id",
                        "in": "path"
                    }
                ],
                "requestBody": {
                    "description": "Product fields to update",
                    "content": {
                        "application/json": {
                            "schema": {
                                "properties": {
                                    "name": {
                                        "type": "string"
                                    },
                                    "price": {
                                        "type": "number",
                                        "format": "float"
                                    },
                                    "description": {
                                        "type": "string"
                                    },
                                    "image": {
                                        "type": "string"
                                    },
                                    "brand": {
                                        "type": "string"
                                    },
                                    "category": {
                                        "type": "string"
                                    },
                                    "countInStock": {
                                        "type": "integer",
                                        "format": "int32"
                                    }
                                },
                                "type": "object"
                            }
                        }
                    },
                    "required": true
                },
                "responses": {
                    "200": {
                        "description": "Product updated",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "_id": {
                                            "type": "string"
                                        },
                                        "name": {
                                            "type": "string"
                                        },
                                        "price": {
                                            "type": "number",
                                            "format": "float"
                                        },
                                        "description": {
                                            "type": "string"
                                        },
                                        "image": {
                                            "type": "string"
                                        },
                                        "brand": {
                                            "type": "string"
                                        },
                                        "category": {
                                            "type": "string"
                                        },
                                        "countInStock": {
                                            "type": "integer",
                                            "format": "int32"
                                        },
                                        "numReviews": {
                                            "type": "integer",
                                            "format": "int32"
                                        },
                                        "rating": {
                                            "type": "number",
                                            "format": "float"
                                        },
                                        "user": {
                                            "type": "string"
                                        },
                                        "reviews": {
                                            "items": {
                                                "properties": {
                                                    "name": {
                                                        "type": "string"
                                                    },
                                                    "rating": {
                                                        "type": "number",
                                                        "format": "float"
                                                    },
                                                    "comment": {
                                                        "type": "string"
                                                    },
                                                    "user": {
                                                        "type": "string"
                                                    }
                                                },
                                                "type": "object"
                                            },
                                            "type": "array"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Product not found",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "message": {
                                            "type": "string"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Unauthorized - authentication required",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "message": {
                                            "type": "string"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "403": {
                        "description": "Forbidden - admin access required",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "message": {
                                            "type": "string"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            },
            "delete": {
                "summary": "Delete a product",
                "description": "Delete a product by id. Access: Private/Admin.",
                "operationId": "c62f9fc336e40886dab88353cc05919f",
                "parameters": [
                    {
                        "description": "Product id (MongoDB ObjectId)",
                        "required": true,
                        "schema": {
                            "type": "string"
                        },
                        "name": "id",
                        "in": "path"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Product removed",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "message": {
                                            "type": "string"
                                        }
                                    },
                                    "type": "object",
                                    "required": [
                                        "message"
                                    ]
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Product not found",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "message": {
                                            "type": "string"
                                        }
                                    },
                                    "type": "object",
                                    "required": [
                                        "message"
                                    ]
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/products/{id}/reviews": {
            "post": {
                "summary": "Create a new review for a product",
                "description": "Create a new review for the product identified by the path parameter id. Requires an authenticated user. Expects a JSON body with rating and optional comment. Returns 201 on success with a message.",
                "operationId": "1fc950183ef20a9d29c98ef7e4229bba",
                "parameters": [
                    {
                        "description": "Product id",
                        "required": true,
                        "schema": {
                            "type": "string"
                        },
                        "name": "id",
                        "in": "path"
                    }
                ],
                "requestBody": {
                    "content": {
                        "application/json": {
                            "schema": {
                                "properties": {
                                    "rating": {
                                        "type": "number",
                                        "description": "Numeric rating provided by the user"
                                    },
                                    "comment": {
                                        "type": "string",
                                        "description": "Optional review comment"
                                    }
                                },
                                "type": "object",
                                "required": [
                                    "rating"
                                ]
                            },
                            "examples": {
                                "review": {
                                    "value": {
                                        "rating": 5,
                                        "comment": "Great product!"
                                    }
                                }
                            }
                        }
                    },
                    "required": true
                },
                "responses": {
                    "201": {
                        "description": "Review created",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "message": {
                                            "type": "string"
                                        }
                                    },
                                    "type": "object"
                                },
                                "examples": {
                                    "created": {
                                        "value": {
                                            "message": "Review added"
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Bad request - product already reviewed",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "message": {
                                            "type": "string"
                                        }
                                    },
                                    "type": "object"
                                },
                                "examples": {
                                    "alreadyReviewed": {
                                        "value": {
                                            "message": "Product already reviewed"
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Product not found",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "message": {
                                            "type": "string"
                                        }
                                    },
                                    "type": "object"
                                },
                                "examples": {
                                    "notFound": {
                                        "value": {
                                            "message": "Product not found"
                                        }
                                    }
                                }
                            }
                        }
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/api/products/top": {
            "get": {
                "tags": [
                    "Products"
                ],
                "summary": "Get top rated products",
                "description": "Get top rated products. Returns up to 3 products sorted by rating in descending order. Public access.",
                "operationId": "9d09e5f0ef968bacd1c6f5bc877b9347",
                "responses": {
                    "200": {
                        "description": "A JSON array of product objects sorted by rating (top 3).",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "items": {
                                        "properties": {
                                            "_id": {
                                                "type": "string"
                                            },
                                            "name": {
                                                "type": "string"
                                            },
                                            "price": {
                                                "type": "number"
                                            },
                                            "user": {
                                                "type": "string"
                                            },
                                            "image": {
                                                "type": "string"
                                            },
                                            "brand": {
                                                "type": "string"
                                            },
                                            "category": {
                                                "type": "string"
                                            },
                                            "countInStock": {
                                                "type": "integer"
                                            },
                                            "numReviews": {
                                                "type": "integer"
                                            },
                                            "description": {
                                                "type": "string"
                                            },
                                            "rating": {
                                                "type": "number"
                                            },
                                            "reviews": {
                                                "items": {
                                                    "properties": {
                                                        "_id": {
                                                            "type": "string"
                                                        },
                                                        "name": {
                                                            "type": "string"
                                                        },
                                                        "rating": {
                                                            "type": "number"
                                                        },
                                                        "comment": {
                                                            "type": "string"
                                                        },
                                                        "user": {
                                                            "type": "string"
                                                        },
                                                        "createdAt": {
                                                            "type": "string",
                                                            "format": "date-time"
                                                        }
                                                    },
                                                    "type": "object"
                                                },
                                                "type": "array"
                                            }
                                        },
                                        "type": "object"
                                    },
                                    "type": "array"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/users/auth": {
            "post": {
                "tags": [
                    "Users"
                ],
                "summary": "Authenticate user & get token",
                "description": "Authenticate a user using email and password. On success a JWT is set in a cookie and basic user information is returned.",
                "operationId": "74198c56965a2606a2f88a55ef156f98",
                "requestBody": {
                    "content": {
                        "application/json": {
                            "schema": {
                                "properties": {
                                    "email": {
                                        "type": "string",
                                        "format": "email"
                                    },
                                    "password": {
                                        "type": "string"
                                    }
                                },
                                "type": "object",
                                "required": [
                                    "email",
                                    "password"
                                ]
                            }
                        }
                    },
                    "required": true
                },
                "responses": {
                    "200": {
                        "description": "Successful authentication - returns user info and sets auth cookie",
                        "headers": {
                            "Set-Cookie": {
                                "description": "JWT cookie for authentication",
                                "schema": {
                                    "type": "string"
                                }
                            }
                        },
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "_id": {
                                            "type": "string"
                                        },
                                        "name": {
                                            "type": "string"
                                        },
                                        "email": {
                                            "type": "string",
                                            "format": "email"
                                        },
                                        "isAdmin": {
                                            "type": "boolean"
                                        }
                                    },
                                    "type": "object",
                                    "required": [
                                        "_id",
                                        "name",
                                        "email",
                                        "isAdmin"
                                    ]
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Invalid email or password",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "message": {
                                            "type": "string"
                                        }
                                    },
                                    "type": "object",
                                    "required": [
                                        "message"
                                    ]
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/users": {
            "get": {
                "tags": [
                    "Users"
                ],
                "summary": "Get all users",
                "description": "Retrieve an array of all users. This endpoint is protected and requires the requester to be an authenticated admin. Authentication is performed via the 'jwt' cookie.",
                "operationId": "bfb806af769045bdb3072f8f02437dc0",
                "responses": {
                    "200": {
                        "description": "A list of user objects",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "items": {
                                        "properties": {
                                            "_id": {
                                                "type": "string"
                                            },
                                            "name": {
                                                "type": "string"
                                            },
                                            "email": {
                                                "type": "string",
                                                "format": "email"
                                            },
                                            "password": {
                                                "type": "string"
                                            },
                                            "isAdmin": {
                                                "type": "boolean"
                                            },
                                            "createdAt": {
                                                "type": "string",
                                                "format": "date-time"
                                            },
                                            "updatedAt": {
                                                "type": "string",
                                                "format": "date-time"
                                            }
                                        },
                                        "type": "object",
                                        "required": [
                                            "_id",
                                            "name",
                                            "email",
                                            "password",
                                            "isAdmin"
                                        ]
                                    },
                                    "type": "array"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Unauthorized - missing or invalid token, or not an admin",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "message": {
                                            "type": "string"
                                        }
                                    },
                                    "type": "object",
                                    "required": [
                                        "message"
                                    ]
                                }
                            }
                        }
                    }
                },
                "security": [
                    {
                        "cookieAuth": []
                    }
                ]
            },
            "post": {
                "tags": [
                    "Users"
                ],
                "summary": "Register a new user",
                "description": "Create a new user account. Expects a JSON body with name, email and password. On success returns 201 with the created user object and sets an authentication cookie. Returns 400 if the user already exists or if provided data is invalid.",
                "operationId": "97c17c6a245dce429a1ed3ef5e4d9cc4",
                "requestBody": {
                    "content": {
                        "application/json": {
                            "schema": {
                                "properties": {
                                    "name": {
                                        "type": "string"
                                    },
                                    "email": {
                                        "type": "string",
                                        "format": "email"
                                    },
                                    "password": {
                                        "type": "string"
                                    }
                                },
                                "type": "object",
                                "required": [
                                    "name",
                                    "email",
                                    "password"
                                ]
                            }
                        }
                    },
                    "required": true
                },
                "responses": {
                    "201": {
                        "description": "Created - user registered successfully",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "_id": {
                                            "type": "string"
                                        },
                                        "name": {
                                            "type": "string"
                                        },
                                        "email": {
                                            "type": "string",
                                            "format": "email"
                                        },
                                        "isAdmin": {
                                            "type": "boolean"
                                        }
                                    },
                                    "type": "object",
                                    "required": [
                                        "_id",
                                        "name",
                                        "email",
                                        "isAdmin"
                                    ]
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Bad Request - user already exists or invalid user data",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "message": {
                                            "type": "string"
                                        }
                                    },
                                    "type": "object",
                                    "required": [
                                        "message"
                                    ]
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/users/logout": {
            "post": {
                "summary": "Logout user / clear cookie",
                "description": "Clears the 'jwt' cookie and returns a confirmation message. Public access.",
                "operationId": "366b11571ec8d2d252a601a39655c90e",
                "responses": {
                    "200": {
                        "description": "Successful logout",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "message": {
                                            "type": "string",
                                            "example": "Logged out successfully"
                                        }
                                    },
                                    "type": "object",
                                    "required": [
                                        "message"
                                    ]
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/users/profile": {
            "get": {
                "summary": "Get user profile",
                "description": "Retrieve the profile of the authenticated user.",
                "operationId": "73d72c4d4bff8a6cfaaea4370426efca",
                "responses": {
                    "200": {
                        "description": "User profile retrieved successfully",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "_id": {
                                            "type": "string"
                                        },
                                        "name": {
                                            "type": "string"
                                        },
                                        "email": {
                                            "type": "string",
                                            "format": "email"
                                        },
                                        "isAdmin": {
                                            "type": "boolean"
                                        }
                                    },
                                    "type": "object",
                                    "required": [
                                        "_id",
                                        "name",
                                        "email",
                                        "isAdmin"
                                    ]
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "User not found",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "message": {
                                            "type": "string"
                                        }
                                    },
                                    "type": "object",
                                    "required": [
                                        "message"
                                    ]
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Unauthorized - authentication required",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "message": {
                                            "type": "string"
                                        }
                                    },
                                    "type": "object",
                                    "required": [
                                        "message"
                                    ]
                                }
                            }
                        }
                    }
                },
                "security": [
                    {
                        "cookieAuth": []
                    }
                ]
            },
            "put": {
                "tags": [
                    "Users"
                ],
                "summary": "Update user profile",
                "description": "Update the authenticated user's profile. Accepts optional name, email, and password fields and returns the updated user (excluding password).",
                "operationId": "c4ce332615d748364f9e54bed0cbf410",
                "requestBody": {
                    "description": "Fields to update for the user. All fields are optional.",
                    "content": {
                        "application/json": {
                            "schema": {
                                "properties": {
                                    "name": {
                                        "type": "string"
                                    },
                                    "email": {
                                        "type": "string",
                                        "format": "email"
                                    },
                                    "password": {
                                        "type": "string"
                                    }
                                },
                                "type": "object"
                            }
                        }
                    },
                    "required": false
                },
                "responses": {
                    "200": {
                        "description": "User updated successfully",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "_id": {
                                            "type": "string"
                                        },
                                        "name": {
                                            "type": "string"
                                        },
                                        "email": {
                                            "type": "string",
                                            "format": "email"
                                        },
                                        "isAdmin": {
                                            "type": "boolean"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "User not found",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "message": {
                                            "type": "string"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    }
                },
                "security": [
                    {
                        "cookieAuth": []
                    }
                ]
            }
        },
        "/api/users/{id}": {
            "get": {
                "summary": "Get user by ID",
                "description": "Retrieve a user by their ID. Access: Private/Admin. The returned user object excludes the password field.",
                "operationId": "7cc470b6b3c87f022cb9bb2ba7ba7a6a",
                "parameters": [
                    {
                        "description": "User ID",
                        "required": true,
                        "schema": {
                            "type": "string"
                        },
                        "name": "id",
                        "in": "path"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "User found and returned",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "_id": {
                                            "type": "string"
                                        },
                                        "name": {
                                            "type": "string"
                                        },
                                        "email": {
                                            "type": "string",
                                            "format": "email"
                                        },
                                        "isAdmin": {
                                            "type": "boolean"
                                        }
                                    },
                                    "type": "object",
                                    "required": [
                                        "_id",
                                        "name",
                                        "email",
                                        "isAdmin"
                                    ]
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "User not found",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "message": {
                                            "type": "string",
                                            "example": "User not found"
                                        }
                                    },
                                    "type": "object",
                                    "required": [
                                        "message"
                                    ]
                                }
                            }
                        }
                    }
                }
            },
            "put": {
                "summary": "Update user",
                "description": "Update user by ID. Access: Private/Admin. Updates name, email and isAdmin for the user identified by the path parameter id and returns the updated user object.",
                "operationId": "7fc24f2a8678db416077200f70c7d914",
                "parameters": [
                    {
                        "description": "User ID",
                        "required": true,
                        "schema": {
                            "type": "string"
                        },
                        "name": "id",
                        "in": "path"
                    }
                ],
                "requestBody": {
                    "content": {
                        "application/json": {
                            "schema": {
                                "properties": {
                                    "name": {
                                        "type": "string"
                                    },
                                    "email": {
                                        "type": "string",
                                        "format": "email"
                                    },
                                    "isAdmin": {
                                        "type": "boolean"
                                    }
                                },
                                "type": "object"
                            }
                        }
                    },
                    "required": true
                },
                "responses": {
                    "200": {
                        "description": "User updated successfully",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "_id": {
                                            "type": "string"
                                        },
                                        "name": {
                                            "type": "string"
                                        },
                                        "email": {
                                            "type": "string",
                                            "format": "email"
                                        },
                                        "isAdmin": {
                                            "type": "boolean"
                                        }
                                    },
                                    "type": "object",
                                    "required": [
                                        "_id",
                                        "name",
                                        "email",
                                        "isAdmin"
                                    ]
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "User not found"
                    }
                }
            },
            "delete": {
                "tags": [
                    "Users"
                ],
                "summary": "Delete user",
                "description": "Delete user by ID. Access: Private/Admin. Looks up the user by the path parameter id, prevents deleting admin users, and returns a confirmation message upon successful deletion.",
                "operationId": "cf8c60dc2c18c5359c864b97b0c180fd",
                "parameters": [
                    {
                        "description": "User ID",
                        "required": true,
                        "schema": {
                            "type": "string"
                        },
                        "name": "id",
                        "in": "path"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "User removed",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "message": {
                                            "type": "string",
                                            "example": "User removed"
                                        }
                                    },
                                    "type": "object",
                                    "required": [
                                        "message"
                                    ]
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Can not delete admin user",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "message": {
                                            "type": "string",
                                            "example": "Can not delete admin user"
                                        }
                                    },
                                    "type": "object",
                                    "required": [
                                        "message"
                                    ]
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "User not found",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "message": {
                                            "type": "string",
                                            "example": "User not found"
                                        }
                                    },
                                    "type": "object",
                                    "required": [
                                        "message"
                                    ]
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/orders": {
            "get": {
                "tags": [
                    "Orders"
                ],
                "summary": "Get all orders",
                "description": "Retrieve all orders. Access: Private/Admin. Returns a JSON array of order objects.",
                "operationId": "ec9b4209200824a14ac0323229312238",
                "responses": {
                    "200": {
                        "description": "A list of orders",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "items": {
                                        "type": "object"
                                    },
                                    "type": "array"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Unauthorized - authentication required"
                    },
                    "403": {
                        "description": "Forbidden - admin access required"
                    },
                    "500": {
                        "description": "Server error"
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            },
            "post": {
                "tags": [
                    "Orders"
                ],
                "summary": "Create new order",
                "description": "Create a new order. Expects orderItems, shippingAddress and paymentMethod in the request body. Prices from the client are not trusted; the server uses product prices from the database. Protected endpoint (requires authentication).",
                "operationId": "70e8f0fb39a2425496cd2c02fb742772",
                "requestBody": {
                    "content": {
                        "application/json": {
                            "schema": {
                                "properties": {
                                    "orderItems": {
                                        "items": {
                                            "properties": {
                                                "_id": {
                                                    "type": "string",
                                                    "description": "Product identifier provided by the client."
                                                }
                                            },
                                            "type": "object",
                                            "required": [
                                                "_id"
                                            ]
                                        },
                                        "type": "array",
                                        "description": "Array of order items provided by the client. Each item must include at least the product _id."
                                    },
                                    "shippingAddress": {
                                        "type": "object",
                                        "description": "Shipping address object (structure provided by client)."
                                    },
                                    "paymentMethod": {
                                        "type": "string",
                                        "description": "Payment method chosen by the client."
                                    }
                                },
                                "type": "object",
                                "required": [
                                    "orderItems",
                                    "shippingAddress",
                                    "paymentMethod"
                                ]
                            }
                        }
                    },
                    "required": true
                },
                "responses": {
                    "201": {
                        "description": "Created - the order was created successfully",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "orderItems": {
                                            "items": {
                                                "properties": {
                                                    "product": {
                                                        "type": "string",
                                                        "description": "Reference to the product id (set by server from the client's provided _id)."
                                                    },
                                                    "price": {
                                                        "type": "number",
                                                        "description": "Price taken from the database for the product."
                                                    }
                                                },
                                                "type": "object"
                                            },
                                            "type": "array"
                                        },
                                        "user": {
                                            "type": "string",
                                            "description": "User id who created the order."
                                        },
                                        "shippingAddress": {
                                            "type": "object",
                                            "description": "Shipping address as stored on the order."
                                        },
                                        "paymentMethod": {
                                            "type": "string"
                                        },
                                        "itemsPrice": {
                                            "type": "number"
                                        },
                                        "taxPrice": {
                                            "type": "number"
                                        },
                                        "shippingPrice": {
                                            "type": "number"
                                        },
                                        "totalPrice": {
                                            "type": "number"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Bad Request - No order items or invalid payload",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "message": {
                                            "type": "string"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Unauthorized - authentication required",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "message": {
                                            "type": "string"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "500": {
                        "description": "Internal Server Error",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "message": {
                                            "type": "string"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/api/orders/mine": {
            "get": {
                "summary": "Get logged in user orders",
                "description": "Retrieve the orders belonging to the authenticated user. Implementation queries Order.find({ user: req.user._id }) and returns the resulting orders as a JSON array.",
                "operationId": "6976c5cc8185cc394c01449400c20e64",
                "responses": {
                    "200": {
                        "description": "A JSON array of order objects belonging to the authenticated user.",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "items": {
                                        "type": "object"
                                    },
                                    "type": "array"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/orders/{id}": {
            "get": {
                "tags": [
                    "Orders"
                ],
                "summary": "Get order by ID",
                "description": "Retrieve a single order by its ID. Requires authentication. The returned order includes populated user name and email when found.",
                "operationId": "ec0b05ee8846fd180e51980de26a6ac9",
                "parameters": [
                    {
                        "description": "ID of the order to retrieve",
                        "required": true,
                        "schema": {
                            "type": "string"
                        },
                        "name": "id",
                        "in": "path"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Order found and returned",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "_id": {
                                            "type": "string"
                                        },
                                        "user": {
                                            "properties": {
                                                "_id": {
                                                    "type": "string"
                                                },
                                                "name": {
                                                    "type": "string"
                                                },
                                                "email": {
                                                    "type": "string",
                                                    "format": "email"
                                                }
                                            },
                                            "type": "object"
                                        },
                                        "orderItems": {
                                            "items": {
                                                "properties": {
                                                    "product": {
                                                        "type": "string",
                                                        "description": "Product id"
                                                    },
                                                    "price": {
                                                        "type": "number",
                                                        "format": "float"
                                                    }
                                                },
                                                "type": "object"
                                            },
                                            "type": "array"
                                        },
                                        "shippingAddress": {
                                            "type": "object",
                                            "description": "Shipping address object provided when creating the order"
                                        },
                                        "paymentMethod": {
                                            "type": "string"
                                        },
                                        "itemsPrice": {
                                            "type": "number",
                                            "format": "float"
                                        },
                                        "taxPrice": {
                                            "type": "number",
                                            "format": "float"
                                        },
                                        "shippingPrice": {
                                            "type": "number",
                                            "format": "float"
                                        },
                                        "totalPrice": {
                                            "type": "number",
                                            "format": "float"
                                        },
                                        "isPaid": {
                                            "type": "boolean"
                                        },
                                        "paidAt": {
                                            "type": "string",
                                            "format": "date-time"
                                        },
                                        "paymentResult": {
                                            "properties": {
                                                "id": {
                                                    "type": "string"
                                                },
                                                "status": {
                                                    "type": "string"
                                                },
                                                "update_time": {
                                                    "type": "string"
                                                },
                                                "email_address": {
                                                    "type": "string",
                                                    "format": "email"
                                                }
                                            },
                                            "type": "object"
                                        },
                                        "isDelivered": {
                                            "type": "boolean"
                                        },
                                        "deliveredAt": {
                                            "type": "string",
                                            "format": "date-time"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Order not found",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "message": {
                                            "type": "string",
                                            "example": "Order not found"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/api/orders/{id}/pay": {
            "put": {
                "tags": [
                    "Orders"
                ],
                "summary": "Update order to paid",
                "description": "Verifies a PayPal payment and, if valid and for the correct amount, marks the order as paid. Expects PayPal transaction details in the request body. Access: Private.",
                "operationId": "e31d5386ea07429b5925a9a0236b3a65",
                "parameters": [
                    {
                        "description": "Order ID",
                        "required": true,
                        "schema": {
                            "type": "string"
                        },
                        "name": "id",
                        "in": "path"
                    }
                ],
                "requestBody": {
                    "description": "PayPal transaction information. The controller uses req.body.id to verify the payment and req.body.payer.email_address.",
                    "content": {
                        "application/json": {
                            "schema": {
                                "properties": {
                                    "id": {
                                        "type": "string",
                                        "description": "PayPal transaction ID (used to verify payment)"
                                    },
                                    "status": {
                                        "type": "string"
                                    },
                                    "update_time": {
                                        "type": "string"
                                    },
                                    "payer": {
                                        "properties": {
                                            "email_address": {
                                                "type": "string",
                                                "format": "email"
                                            }
                                        },
                                        "type": "object",
                                        "required": [
                                            "email_address"
                                        ]
                                    }
                                },
                                "type": "object",
                                "required": [
                                    "id"
                                ]
                            }
                        }
                    },
                    "required": true
                },
                "responses": {
                    "200": {
                        "description": "Order updated to paid",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Order not found"
                    },
                    "400": {
                        "description": "Payment not verified, incorrect amount paid, or transaction already used"
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/api/orders/{id}/deliver": {
            "put": {
                "tags": [
                    "Orders"
                ],
                "summary": "Update order to delivered",
                "description": "Mark an order as delivered. Access: Private/Admin. Sets isDelivered to true and deliveredAt to the current timestamp, then returns the updated order. Returns 404 if the order is not found.",
                "operationId": "b32767bd6043441160bc22e04eb92c95",
                "parameters": [
                    {
                        "description": "Order ID",
                        "required": true,
                        "schema": {
                            "type": "string"
                        },
                        "name": "id",
                        "in": "path"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Order marked as delivered and returned",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "isDelivered": {
                                            "type": "boolean"
                                        },
                                        "deliveredAt": {
                                            "type": "string",
                                            "format": "date-time"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Order not found",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "message": {
                                            "type": "string"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        }
    }
}